import{f as c,g,r as S,p as v,w as f,a as w,c as p,b as l,h as i,k as u,j as y,s,d as x,F as V,n as h,t as r,i as m,o as C}from"./index-BWUivkLa.js";const F=c("estimate",{state:()=>({error:null,loading:!1,slabCount:0,totalCm:0,wagePerCm:80,selectedStone:"",unitStonePrice:0,pricePerCm:0,stoneList:[],calcSteps:""}),actions:{selectStone(n){const t=this.stoneList.find(a=>a.name===n);t&&(this.selectedStone=t.name,this.unitStonePrice=t.price)},calculatePricePerCm(){if(this.totalCm>0){const n=this.slabCount*this.unitStonePrice/this.totalCm;this.pricePerCm=this.wagePerCm+n,this.calcSteps=`公式：(${this.slabCount} × ${this.unitStonePrice}) ÷ ${this.totalCm} + ${this.wagePerCm}
= ${n.toFixed(2)} + ${this.wagePerCm} = ${this.pricePerCm.toFixed(2)} 元/cm`}else this.pricePerCm=0,this.calcSteps="請輸入有效的總公分數。"},async fetchData(){this.loading=!0,this.error=null;try{const n=await g.get("https://script.google.com/macros/s/AKfycbweY4uKhj-NmmqmaKMD401ePMjVrGEE7_fuYNSmEYAOk4I4pW2garBtDCtYehV-I0oX/exec");this.stoneList=n.data.filter(t=>t.name!=="")}catch(n){this.error="資料抓取失敗，請稍後再試",console.error(n)}finally{this.loading=!1}}},getters:{totalEstimate(n){return n.totalCm*n.pricePerCm}}}),L={class:"p-4 space-y-2"},k=["value"],E={key:0,disabled:""},$={class:"mt-3 space-y-1"},D={class:"text-blue-700"},U={class:"bg-gray-100 p-2 rounded text-sm whitespace-pre-wrap"},N={__name:"FuturePrice",setup(n){const t=F(),a=S("大");v(()=>{t.fetchData()}),f(()=>[t.slabCount,t.unitStonePrice,t.wagePerCm,t.totalCm],()=>{t.calculatePricePerCm()});const b=w(()=>t.stoneList.filter(d=>d.name.toLowerCase().includes(a.value.toLowerCase())));function P(d){t.selectStone(d.target.value)}return(d,e)=>(C(),p("div",L,[e[17]||(e[17]=l("h2",{class:"text-lg font-bold"},"每公分報價計算",-1)),l("div",null,[i(l("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>a.value=o),placeholder:"搜尋石材",class:"border mb-2"},null,512),[[u,a.value]]),e[7]||(e[7]=l("label",null,"選擇石材：",-1)),i(l("select",{"onUpdate:modelValue":e[1]||(e[1]=o=>s(t).selectedStone=o),onChange:P,class:"border"},[e[6]||(e[6]=l("option",{disabled:"",value:""},"請選擇",-1)),(C(!0),p(V,null,h(b.value,o=>(C(),p("option",{key:o.name,value:o.name},r(o.name)+"（"+r(o.price)+" 元/片） ",9,k))),128)),b.value.length===0?(C(),p("option",E," 查無符合石材 ")):x("",!0)],544),[[y,s(t).selectedStone]])]),l("div",null,[e[8]||(e[8]=l("label",null,"大板價格：",-1)),i(l("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>s(t).unitStonePrice=o),type:"number",class:"border"},null,512),[[u,s(t).unitStonePrice,void 0,{number:!0}]])]),l("div",null,[e[9]||(e[9]=l("label",null,"大板數量：",-1)),i(l("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>s(t).slabCount=o),type:"number",class:"border"},null,512),[[u,s(t).slabCount,void 0,{number:!0}]])]),l("div",null,[e[10]||(e[10]=l("label",null,"總公分數：",-1)),i(l("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>s(t).totalCm=o),type:"number",class:"border"},null,512),[[u,s(t).totalCm,void 0,{number:!0}]])]),l("div",null,[e[11]||(e[11]=l("label",null,"每公分加工工資：",-1)),i(l("input",{"onUpdate:modelValue":e[5]||(e[5]=o=>s(t).wagePerCm=o),type:"number",class:"border"},null,512),[[u,s(t).wagePerCm,void 0,{number:!0}]])]),l("div",$,[l("p",null,"石材單價："+r(s(t).unitStonePrice)+" 元/片",1),l("p",D,[e[12]||(e[12]=m(" 每公分報價： ")),l("strong",null,r(s(t).pricePerCm.toFixed(2)),1),e[13]||(e[13]=m(" 元/cm "))])]),l("p",null,[e[14]||(e[14]=m(" 毛利率：")),l("strong",null,r((s(t).wagePerCm/s(t).pricePerCm*100).toFixed(2))+" % ("+r(s(t).wagePerCm)+" / "+r(s(t).pricePerCm)+")",1)]),l("p",null,[e[15]||(e[15]=m(" 總估價金額：")),l("strong",null,r(s(t).totalEstimate.toFixed(0)),1),e[16]||(e[16]=m(" 元 "))]),l("pre",U,r(s(t).calcSteps)+`
  `,1)]))}};export{N as default};
